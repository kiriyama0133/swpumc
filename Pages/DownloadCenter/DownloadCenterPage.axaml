<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:sukiUi="clr-namespace:SukiUI.Controls;assembly=SukiUI"
             xmlns:material="clr-namespace:Material.Icons.Avalonia;assembly=Material.Icons.Avalonia"
             xmlns:versionCard="clr-namespace:swpumc.Controls.VersionCard"
             mc:Ignorable="d" d:DesignWidth="1200" d:DesignHeight="800"
             x:Class="swpumc.Pages.DownloadCenter.DownloadCenterPage">
    
    <sukiUi:BusyArea IsBusy="{Binding IsLoading}" BusyText="获取版本信息...">
        <Grid Margin="20">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>
        
        <!-- 页面标题 -->
        <sukiUi:GlassCard Grid.Row="0" 
                          CornerRadius="15" 
                          Padding="20"
                          Margin="0,0,0,20">
            <StackPanel>
                <StackPanel Orientation="Horizontal" Spacing="15">
                    <material:MaterialIcon Kind="Download"
                                          Width="32" 
                                          Height="32"
                                          Foreground="{DynamicResource SukiPrimaryColor}"
                                          VerticalAlignment="Center"/>
                    <StackPanel>
                        <TextBlock Text="下载中心" 
                                   FontSize="24" 
                                   FontWeight="Bold"
                                   Foreground="{DynamicResource SukiText}"/>
                        <TextBlock Text="下载和管理Minecraft版本" 
                                   FontSize="14"
                                   Foreground="{DynamicResource SukiLowText}"
                                   Margin="0,5,0,0"/>
                    </StackPanel>
                </StackPanel>
                
                <!-- 操作按钮 -->
                <StackPanel Orientation="Horizontal" Spacing="10" Margin="0,15,0,0">
                    <Button Classes="Standard Primary" 
                            Content="刷新版本"
                            Command="{Binding RefreshVersionsCommand}">
                        <Button.Content>
                            <StackPanel Orientation="Horizontal" Spacing="8">
                                <material:MaterialIcon Kind="Refresh"
                                                      Width="16" 
                                                      Height="16"/>
                                <TextBlock Text="刷新版本" 
                                           FontWeight="SemiBold"/>
                            </StackPanel>
                        </Button.Content>
                    </Button>
                    
                    <Button Classes="Standard" 
                            Content="筛选"
                            Command="{Binding FilterVersionsCommand}">
                        <Button.Content>
                            <StackPanel Orientation="Horizontal" Spacing="8">
                                <material:MaterialIcon Kind="Filter"
                                                      Width="16" 
                                                      Height="16"
                                                      Foreground="{DynamicResource SukiText}"/>
                                <TextBlock Text="筛选" 
                                           Foreground="{DynamicResource SukiText}"
                                           FontWeight="SemiBold"/>
                            </StackPanel>
                        </Button.Content>
                    </Button>
                </StackPanel>
            </StackPanel>
        </sukiUi:GlassCard>
        
        <!-- 版本列表 -->
        <sukiUi:GlassCard Grid.Row="1" 
                          CornerRadius="15" 
                          Padding="20">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                
                <!-- 版本统计信息 -->
                <StackPanel Grid.Row="0" Orientation="Horizontal" Spacing="20" Margin="0,0,0,20">
                    <StackPanel Orientation="Horizontal" Spacing="8">
                        <material:MaterialIcon Kind="CheckCircle"
                                              Width="20" 
                                              Height="20"
                                              Foreground="Green"/>
                        <TextBlock Text="{Binding ReleaseCount}" 
                                   FontSize="14" 
                                   FontWeight="SemiBold"
                                   Foreground="{DynamicResource SukiText}"/>
                        <TextBlock Text="正式版" 
                                   FontSize="14"
                                   Foreground="{DynamicResource SukiLowText}"/>
                    </StackPanel>
                    
                    <StackPanel Orientation="Horizontal" Spacing="8">
                        <material:MaterialIcon Kind="Code"
                                              Width="20" 
                                              Height="20"
                                              Foreground="Orange"/>
                        <TextBlock Text="{Binding SnapshotCount}" 
                                   FontSize="14" 
                                   FontWeight="SemiBold"
                                   Foreground="{DynamicResource SukiText}"/>
                        <TextBlock Text="快照版" 
                                   FontSize="14"
                                   Foreground="{DynamicResource SukiLowText}"/>
                    </StackPanel>
                    
                    <StackPanel Orientation="Horizontal" Spacing="8">
                        <material:MaterialIcon Kind="FormatListBulleted"
                                              Width="20" 
                                              Height="20"
                                              Foreground="{DynamicResource SukiPrimaryColor}"/>
                        <TextBlock Text="{Binding TotalCount}" 
                                   FontSize="14" 
                                   FontWeight="SemiBold"
                                   Foreground="{DynamicResource SukiText}"/>
                        <TextBlock Text="总计" 
                                   FontSize="14"
                                   Foreground="{DynamicResource SukiLowText}"/>
                    </StackPanel>
                </StackPanel>
                
                            <!-- 版本卡片网格 -->
                            <ScrollViewer Grid.Row="1" 
                                          VerticalScrollBarVisibility="Auto"
                                          Name="VersionScrollViewer">
                                <StackPanel>
                                    <ItemsControl ItemsSource="{Binding Versions}">
                                        <ItemsControl.ItemTemplate>
                                            <DataTemplate>
                                                <versionCard:VersionCard DataContext="{Binding .}"/>
                                            </DataTemplate>
                                        </ItemsControl.ItemTemplate>
                                        <ItemsControl.ItemsPanel>
                                            <ItemsPanelTemplate>
                                                <WrapPanel Orientation="Horizontal" Margin="0,0,0,15"/>
                                            </ItemsPanelTemplate>
                                        </ItemsControl.ItemsPanel>
                                    </ItemsControl>
                                    
                                    <!-- 加载更多按钮 -->
                                    <Button Content="加载更多版本"
                                            Command="{Binding LoadMoreVersionsCommand}"
                                            IsEnabled="{Binding HasMorePages}"
                                            IsVisible="{Binding HasMorePages}"
                                            Classes="Standard"
                                            HorizontalAlignment="Center"
                                            Margin="0,20,0,20"
                                            Padding="20,10">
                                        <Button.Content>
                                            <StackPanel Orientation="Horizontal" Spacing="8">
                                                <material:MaterialIcon Kind="Refresh"
                                                                      Width="16" 
                                                                      Height="16"/>
                                                <TextBlock Text="加载更多版本" 
                                                           FontWeight="SemiBold"/>
                                            </StackPanel>
                                        </Button.Content>
                                    </Button>
                                    
                                    <!-- 加载中指示器 -->
                                    <StackPanel Orientation="Horizontal" 
                                                HorizontalAlignment="Center"
                                                Spacing="10"
                                                IsVisible="{Binding IsLoadingMore}"
                                                Margin="0,20,0,20">
                                        <ProgressBar IsIndeterminate="True" 
                                                     Width="20" 
                                                     Height="20"/>
                                        <TextBlock Text="正在加载更多版本..." 
                                                   VerticalAlignment="Center"
                                                   Foreground="{DynamicResource SukiLowText}"/>
                                    </StackPanel>
                                    
                                    <!-- 没有更多内容提示 -->
                                    <TextBlock Text="已显示所有版本"
                                               HorizontalAlignment="Center"
                                               Foreground="{DynamicResource SukiLowText}"
                                               FontSize="14"
                                               Margin="0,20,0,20"
                                               IsVisible="{Binding !HasMorePages}"/>
                                </StackPanel>
                            </ScrollViewer>
            </Grid>
        </sukiUi:GlassCard>
        </Grid>
    </sukiUi:BusyArea>
</UserControl>
